<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>BOL Timer ‚Äì Offline verzia</title>

  <link rel="stylesheet" href="css/styles.css" />

  <!-- D√¥le≈æit√©: lok√°lne kni≈ænice, NIE z internetu -->
<script src="libs/index.js"></script>

  <!-- Na≈°a logika -->
  <script defer type="module" src="js/app_php.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>BOL Timer ‚Äì Offline verzia</h1>
    <div class="top-actions">
      <a class="btn ghost" href="api/export_xls.php">‚¨áÔ∏è Export Excel (.xls)</a>
      <button id="btnAdmin" class="btn">Admin</button>
    </div>
  </header>

  <main class="container">
    <!-- SKENER -->
    <section class="card">
      <h2>Skener (kamera alebo fotka)</h2>
      <p class="muted">
        Ak ≈æiv√° kamera nep√¥jde (kv√¥li povoleniam), pou≈æi üì∏ Foto sken.
      </p>

      <div class="controls">
        <button id="btnLive" class="btn">‚ñ∂ ≈Ωiv√° kamera</button>
        <button id="btnStopLive" class="btn ghost" style="display:none">‚úñ Stop kamera</button>
        <button id="btnFlip" class="btn ghost" style="display:none">üîÅ Prepn√∫≈• kameru</button>
        <button id="btnPhoto" class="btn ghost">üì∏ Foto sken</button>
      </div>

      <div id="secureWarn" class="warn" style="display:none">
        Upozornenie: niektor√© mobily blokuj√∫ kameru bez HTTPS.
      </div>

      <div id="liveWrap" class="live-wrap" style="display:none">
        <video id="video" autoplay muted playsinline></video>
        <div class="overlay">
          <div id="detBadge" class="badge" style="display:none"></div>
        </div>
      </div>

      <div class="row mt">
        <input id="inpCode" class="input" placeholder="Naskenuj alebo zadaj k√≥d..." />
        <button id="btnClear" class="btn ghost">üßπ Vymaza≈•</button>
      </div>

      <div class="muted" id="meta">Form√°t: ‚Äî ‚Ä¢ Zdroj: ‚Äî</div>
    </section>

    <!-- TIMER -->
    <section class="card">
      <h2>√öloha</h2>

      <div class="row">
        <div class="col">
          <label>Meno zamestnanca</label>
          <input id="inpName" class="input" placeholder="napr. Jana K." />
        </div>
        <div class="col">
          <label>Zostalo (kart√≥ny) ‚Äì vypln√≠ sa pri Stop</label>
          <input disabled class="input" value="-" />
        </div>
      </div>

      <div class="controls mt">
        <button id="btnStart" class="btn">‚ñ∂ ≈†tart</button>
        <button id="btnPause" class="btn ghost" style="display:none">‚è∏ Pauza</button>
        <button id="btnResume" class="btn" style="display:none">‚èµ Pokraƒçova≈•</button>
        <button id="btnStop" class="btn danger" style="display:none">‚èπ Stop</button>
      </div>

      <div id="activeBox" class="active-box" style="display:none">
        <div>
          <div class="muted">Akt√≠vna √∫loha</div>
          <div id="lblMeta" class="meta-strong">-</div>
        </div>
        <div class="timer">
          <div id="lblTimer" class="big">00:00:00</div>
          <div class="muted">ƒåist√Ω ƒças</div>
        </div>
      </div>
    </section>

    <!-- TABUƒΩKA -->
    <section class="card">
      <div class="row space-between">
        <h2>Z√°znamy</h2>
        <div class="row">
          <button id="btnReload" class="btn ghost">‚Üª Naƒç√≠ta≈• znova</button>
          <button id="btnExportCSV" class="btn ghost">Export CSV (zobrazen√©)</button>
        </div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>K√≥d</th>
              <th>Meno</th>
              <th>≈†tart</th>
              <th>Koniec</th>
              <th>ƒåist√Ω ƒças</th>
              <th>Pauzy</th>
              <th>Zostalo</th>
            </tr>
          </thead>
          <tbody id="tbl"></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- MODAL: Admin -->
  <div id="adminModal" class="modal" style="display:none">
    <div class="modal-inner">
      <h3>Admin</h3>

      <div class="row">
        <button id="btnSyncNow" class="btn">‚Üª Naƒç√≠ta≈• zo s√∫boru</button>
        <button id="btnClearAll" class="btn danger">Vypr√°zdni≈• s√∫bor</button>
        <button id="btnCloseAdmin" class="btn ghost">Zavrie≈•</button>
      </div>

      <div class="table-wrap mt">
        <table>
          <thead>
            <tr>
              <th>K√≥d</th>
              <th>Meno</th>
              <th>Start ISO</th>
              <th>End ISO</th>
              <th>ƒåist√Ω ƒças</th>
              <th>Pauzy</th>
              <th>Zostalo</th>
            </tr>
          </thead>
          <tbody id="tblAdmin"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- MODAL: Kart√≥ny po Stop -->
  <div id="leftModal" class="modal" style="display:none">
    <div class="modal-inner small">
      <h3>Zostalo do skladu (kart√≥ny)</h3>
      <div class="row">
        <input id="inpLeft" class="input" type="number" min="0" step="1" value="0" />
        <button id="btnLeftSave" class="btn">Ulo≈æi≈•</button>
      </div>
    </div>
  </div>

  <!-- zvuk pri skene -->
  <audio id="beep">
    <source
      src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAAAACABYAAAABAQAA"
      type="audio/wav" />
  </audio>
</body>
</html>
